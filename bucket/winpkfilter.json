{
    "version": "3.6.2",
    "description": "A library for network packet interception and manipulation, suitable for custom firewall, VPN and traffic analysis applications.",
    "homepage": "https://github.com/wiresock/ndisapi",
    "license": "MIT",
    "architecture": {
        "32bit": {
            "url": "https://github.com/wiresock/ndisapi/releases/download/v3.6.2/Windows.Packet.Filter.3.6.2.1.x86.msi",
            "hash": "ff882c295f9bb0c4465b179e912ad2d2c41eadc053142bd2f125f49a85ee4e1f",
            "extract_dir": "PFiles\\Windows Packet Filter"
        },
        "64bit": {
            "url": "https://github.com/wiresock/ndisapi/releases/download/v3.6.2/Windows.Packet.Filter.3.6.2.1.x64.msi",
            "hash": "9c388c0b7f189f7fa98720bae2caecf7d64f30910838b80b438ecf8956b8502c",
            "extract_dir": "PFiles64\\Windows Packet Filter"
        },
        "arm64": {
            "url": "https://github.com/wiresock/ndisapi/releases/download/v3.6.2/Windows.Packet.Filter.3.6.2.1.ARM64.msi",
            "hash": "b13c6832c9e5c0c14948bbf5c17ccbe65dff55c0f6069df01494d97ebd1f3d69",
            "extract_dir": "PFiles64\\Windows Packet Filter"
        }
    },
    "pre_install": [
        "if (!(is_admin)) { throw 'Administrator privileges are required' }",
        "certutil.exe -addstore -f \"TrustedPublisher\" \"$dir\\certificates\\sha256\\cert_ip.cer\"",
        "$os = [Version]::new((Get-CimInstance Win32_OperatingSystem).Version)",
        "if ($os.Major -ge 10) { $drivers = \"$dir\\drivers\\win10\" }",
        "elseif ($os.Major -ge 6 -and $os.Minor -ge 2) { $drivers = \"$dir\\drivers\\win8\" }",
        "elseif ($os.Major -ge 6 -and $os.Minor -ge 1) { $drivers = \"$dir\\drivers\\win7\" }",
        "else { $drivers = \"$dir\\drivers\\vista\" }",
        "netcfg.exe -v -l \"$drivers\\ndisrd_lwf.inf\" -c s -i nt_ndisrd",
        "REG ADD 'HKLM\\Software\\NTKernelResources\\WinpkFilter' /f > nul;",
        "Set-ItemProperty -Path 'HKLM:\\Software\\NTKernelResources\\WinpkFilter' -Name 'InstallLocation' -Value \"$dir\";"
    ],
    "pre_uninstall": [
        "REG DELETE HKLM\\Software\\NTKernelResources\\WinpkFilter /f > nul;",
        "netcfg.exe -v -u nt_ndisrd",
        "certutil.exe -delstore \"TrustedPublisher\" ((certutil.exe -hashfile \"$dir\\certificates\\sha256\\cert_ip.cer\" SHA1) -match '^[0-9A-F]{40}$')"
    ],
    "checkver": "github",
    "autoupdate": {
        "architecture": {
            "32bit": {
                "url": "https://github.com/wiresock/ndisapi/releases/download/v$version/Windows.Packet.Filter.$version.1.x86.msi"
            },
            "64bit": {
                "url": "https://github.com/wiresock/ndisapi/releases/download/v$version/Windows.Packet.Filter.$version.1.x64.msi"
            },
            "arm64": {
                "url": "https://github.com/wiresock/ndisapi/releases/download/v$version/Windows.Packet.Filter.$version.1.ARM64.msi"
            }
        }
    }
}
