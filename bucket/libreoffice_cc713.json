{
    "version": "25.8.3.2",
    "description": "Powerful and free office suite, a successor to OpenOffice(.org).",
    "homepage": "https://libreoffice.org/",
    "license": "MPL-2.0",
    "suggest": {
        "vcredist": "extras/vcredist2022"
    },
    "notes": "If you are upgrading from portable version, you can migrate settings by copying \"$persist_dir\\Data\" to \"%AppData%\\LibreOffice\"",
    "architecture": {
        "64bit": {
            "url": "https://downloadarchive.documentfoundation.org/libreoffice/old/25.8.3.2/win/x86_64/LibreOffice_25.8.3.2_Win_x86-64.msi#/dl.msi_",
            "hash": "0db4e53a99129abaa867bc504dfcd3264a622b27a63ade3e5c5fd92185d0408b"
        },
        "32bit": {
            "url": "https://downloadarchive.documentfoundation.org/libreoffice/old/25.8.3.2/win/x86/LibreOffice_25.8.3.2_Win_x86.msi#/dl.msi_",
            "hash": "d65b2c45a0776f250f71d3a6ac54ad29c5b5fc0e33e581e6acf7eeb7cb51fffd"
        },
        "arm64": {
            "url": "https://downloadarchive.documentfoundation.org/libreoffice/old/25.8.3.2/win/aarch64/LibreOffice_25.8.3.2_Win_aarch64.msi#/dl.msi_",
            "hash": "fe2e4095ff377bbcad15c60071c6a6945503011abdf6751d9241afce469db176"
        }
    },
    "pre_install": [
        "# keeping files in 'LibreOffice' directory so that bundled font can work properly",
        "ensure \"$dir\\LibreOffice\\share\\fonts\" | Out-Null",
        "# usage: get_config ($name, $default). $default ==> set to what value if the value is empty (not being set before)",
        "if (get_config USE_LESSMSI $false) {",
        "    # if 'use_lessmsi' is true",
        "    Expand-MsiArchive \"$dir\\dl.msi_\" \"$dir\" | Out-Null",
        "    Move-Item \"$dir\\Fonts\" \"$dir\\LibreOffice\\share\\fonts\\truetype\" -Force",
        "    Remove-Item \"$dir\\System*\" -Recurse -Force",
        "} else {",
        "    # if 'use_lessmsi' is false or not set",
        "    Expand-MsiArchive \"$dir\\dl.msi_\" \"$dir\\LibreOffice\" | Out-Null",
        "    Expand-MsiArchive \"$dir\\dl.msi_\" \"$dir\\LibreOffice\\share\\fonts\\truetype\" -ExtractDir 'Fonts' | Out-Null",
        "    Remove-Item \"$dir\\LibreOffice\\Fonts\", \"$dir\\LibreOffice\\System*\" -Recurse -Force",
        "}",
        "Remove-Item \"$dir\\dl.msi_\""
    ],
    "shortcuts": [
        [
            "LibreOffice\\LibreOffice\\program\\soffice.exe",
            "LibreOffice\\LibreOffice"
        ],
        [
            "LibreOffice\\LibreOffice\\program\\sbase.exe",
            "LibreOffice\\LibreOffice Base"
        ],
        [
            "LibreOffice\\LibreOffice\\program\\scalc.exe",
            "LibreOffice\\LibreOffice Calc"
        ],
        [
            "LibreOffice\\LibreOffice\\program\\sdraw.exe",
            "LibreOffice\\LibreOffice Draw"
        ],
        [
            "LibreOffice\\LibreOffice\\program\\simpress.exe",
            "LibreOffice\\LibreOffice Impress"
        ],
        [
            "LibreOffice\\LibreOffice\\program\\smath.exe",
            "LibreOffice\\LibreOffice Math"
        ],
        [
            "LibreOffice\\LibreOffice\\program\\swriter.exe",
            "LibreOffice\\LibreOffice Writer"
        ]
    ],
    "checkver": {
        "url": "https://downloadarchive.documentfoundation.org/libreoffice/old/latest/win/x86_64/",
        "regex": "LibreOffice_([\\d.]+)_Win_x86-64.msi"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://downloadarchive.documentfoundation.org/libreoffice/old/$version/win/x86_64/LibreOffice_$version_Win_x86-64.msi#/dl.msi_"
            },
            "32bit": {
                "url": "https://downloadarchive.documentfoundation.org/libreoffice/old/$version/win/x86/LibreOffice_$version_Win_x86.msi#/dl.msi_"
            },
            "arm64": {
                "url": "https://downloadarchive.documentfoundation.org/libreoffice/old/$version/win/aarch64/LibreOffice_$version_Win_aarch64.msi#/dl.msi_"
            }
        },
        "hash": {
            "url": "$url.sha256"
        }
    }
}
