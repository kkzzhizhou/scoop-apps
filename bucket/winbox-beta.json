{
    "version": "4.0.rc1",
    "description": "A small utility that allows administration of MikroTik RouterOS using a fast and simple GUI.",
    "homepage": "https://mikrotik.com/",
    "license": "Unknown",
    "notes": [
        "This manifest uses a script, which requires admin privileges, to modify Windows firewall rules for WinBox.",
        "If it failed in installation, you can manually run:",
        "gsudo \"$dir\\update-firewall-rules.ps1\""
    ],
    "depends": "main/gsudo",
    "architecture": {
        "64bit": {
            "url": "https://download.mikrotik.com/routeros/winbox/4.0rc1/WinBox_Windows.zip",
            "hash": "9b5a5aa214553ebead888cf8048c1010410a1a13e9333d44137f87578ae18e87",
            "bin": [
                [
                    "WinBox.exe",
                    "winbox"
                ]
            ],
            "shortcuts": [
                [
                    "WinBox.exe",
                    "WinBox Beta"
                ]
            ]
        }
    },
    "post_install": [
        "$ScriptsDir = Find-BucketDirectory -Root -Name $bucket | Join-Path -ChildPath \"scripts\\winbox-beta\"",
        "$BinPath = Get-ChildItem -Path \"$dir\" -Filter \"WinBox.exe\" | Select-Object -ExpandProperty Target",
        "if (Test-Path \"$ScriptsDir\\update-firewall-rules.ps1\") {",
        "    $Content = Get-Content \"$ScriptsDir\\update-firewall-rules.ps1\" -Encoding UTF8",
        "    $Content = $Content.Replace('$BinPath', \"$BinPath\")",
        "    $Content | Out-File -FilePath \"$dir\\update-firewall-rules.ps1\" -Encoding UTF8",
        "    Write-Host \"`nUpdating Windows firewall rules...\" -ForegroundColor Yellow",
        "    Write-Host \"Please approve permission request if UAC prompt pops up.\" -ForegroundColor Yellow",
        "    Start-Sleep -Seconds 1",
        "    gsudo \"$dir\\update-firewall-rules.ps1\"",
        "    if ($?) {",
        "        Write-Host \"Successfully updated Windows firewall rules!\" -ForegroundColor Green",
        "    } else {",
        "        Write-Host \"[ERROR] Failed updating Windows firewall rules!\" -ForegroundColor Red",
        "    }",
        "} else {",
        "    Write-Host \"Missing files, please re-add Scoop4kariiin bucket and re-install this app.\" -ForegroundColor Red",
        "}"
    ],
    "checkver": {
        "url": "https://mikrotik.com/download/winbox",
        "regex": ">v([\\d.]+)([beta]*)([rc]*\\d+)<",
        "replace": "${1}.${3}"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://download.mikrotik.com/routeros/winbox/$match1$match2$match3/WinBox_Windows.zip",
                "hash": {
                    "url": "https://download.mikrotik.com/routeros/winbox/$match1$match2$match3/WinBox_Windows.zip.sha256"
                }
            }
        }
    }
}
