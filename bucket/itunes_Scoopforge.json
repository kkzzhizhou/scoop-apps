{
    "version": "12.13.7.1",
    "description": "Media player, mobile device management utility, iTunes Store client",
    "license": "Proprietary",
    "homepage": "https://www.apple.com/itunes/",
    "architecture": {
        "64bit": {
            "url": "https://www.apple.com/itunes/download/win64#/dl.7z",
            "hash": "2f5a7f4a85e24810297cb3ef63fd6d743df1c62edfc5e4ca3677c7b083bc2ff0"
        },
        "32bit": {
            "url": "https://www.apple.com/itunes/download/win32#/dl.7z",
            "hash": "12d8edf49fed3252e86ca94304ef44556c1fb8adc5f1832e36bb9b932bd2f99d"
        }
    },
    "pre_install": [
        "if (-not $global) {",
        "   throw 'This package must be installed globally.'",
        "}",
        "Remove-Item \"$dirSetupAdmin.exe\", \"$dirAppleSoftwareUpdate.msi\"",
        "Stop-Service 'Apple Mobile Device Service' -ErrorAction SilentlyContinue",
        "Stop-Service 'Bonjour Service' -ErrorAction SilentlyContinue"
    ],
    "installer": {
        "script": [
            "$binary_suffix = ''",
            "if ($architecture -eq \"64bit\") {",
            "   $binary_suffix = '64'",
            "}",
            "Invoke-ExternalCommand msiexec -ArgumentList @('/i', \"$diriTunes$binary_suffix.msi\", '/qn', '/norestart', \"TARGETDIR=$dir\", \"INSTALLDIR=$dir\") -RunAs | Out-Null",
            "Invoke-ExternalCommand msiexec -ArgumentList @('/i', \"$dirAppleMobileDeviceSupport$binary_suffix.msi\", '/qn', '/norestart', \"TARGETDIR=$dirAppleMobileDeviceSupport\", \"INSTALLDIR=$dirAppleMobileDeviceSupport\") -RunAs | Out-Null",
            "Invoke-ExternalCommand msiexec -ArgumentList @('/i', \"$dirBonjour$binary_suffix.msi\", '/qn', '/norestart', \"TARGETDIR=$dirBonjour\", \"INSTALLDIR=$dirBonjour\") -RunAs | Out-Null",
            "if (Test-Path \"$dirAppleApplicationSupport64.msi\") {",
            "    Invoke-ExternalCommand msiexec -ArgumentList @('/i', \"$dirAppleApplicationSupport64.msi\", '/qn', '/norestart', \"TARGETDIR=$dirAppleApplicationSupport\", \"INSTALLDIR=$dirAppleApplicationSupport\") -RunAs | Out-Null",
            "}",
            "if (Test-Path \"$dirAppleApplicationSupport.msi\") {",
            "    Invoke-ExternalCommand msiexec -ArgumentList @('/i', \"$dirAppleApplicationSupport.msi\", '/qn', '/norestart', \"TARGETDIR=$dirAppleApplicationSupport\", \"INSTALLDIR=$dirAppleApplicationSupport\") -RunAs | Out-Null",
            "}",
            "if (Test-Path \"$dirQuickTime.msi\") {",
            "    Invoke-ExternalCommand msiexec -ArgumentList @('/i', \"$dirQuickTime.msi\", '/qn', '/norestart', \"TARGETDIR=$dirQuickTime\", \"INSTALLDIR=$dirQuickTime\") -RunAs | Out-Null",
            "}"
        ]
    },
    "post_install": [
        "Remove-Item -Recurse \"$([Environment]::GetFolderPath('CommonStartMenu'))ProgramsiTunes\"",
        "Remove-Item -Recurse \"$([Environment]::GetFolderPath('CommonDesktopDirectory'))iTunes.lnk\""
    ],
    "pre_uninstall": [
        "Stop-Service 'Apple Mobile Device Service'",
        "Stop-Service 'Bonjour Service'"
    ],
    "uninstaller": {
        "script": [
            "$binary_suffix = ''",
            "if ($architecture -eq \"64bit\") {",
            "   $binary_suffix = '64'",
            "}",
            "Invoke-ExternalCommand msiexec -ArgumentList @('/x', \"$diriTunes$binary_suffix.msi\", '/qn', '/norestart') -RunAs | Out-Null",
            "Invoke-ExternalCommand msiexec -ArgumentList @('/x', \"$dirAppleMobileDeviceSupport$binary_suffix.msi\", '/qn', '/norestart') -RunAs | Out-Null",
            "Invoke-ExternalCommand msiexec -ArgumentList @('/x', \"$dirBonjour$binary_suffix.msi\", '/qn', '/norestart') -RunAs | Out-Null",
            "if (Test-Path \"$dirAppleApplicationSupport64.msi\") {",
            "   Invoke-ExternalCommand msiexec -ArgumentList @('/x', \"$dirAppleApplicationSupport64.msi\", '/qn', '/norestart') -RunAs | Out-Null",
            "}",
            "if (Test-Path \"$dirAppleApplicationSupport.msi\") {",
            "   Invoke-ExternalCommand msiexec -ArgumentList @('/x', \"$dirAppleApplicationSupport.msi\", '/qn', '/norestart') -RunAs | Out-Null",
            "}",
            "if (Test-Path \"$dirQuickTime.msi\") {",
            "    Invoke-ExternalCommand msiexec -ArgumentList @('/x', \"$dirQuickTime.msi\", '/qn', '/norestart', \"TARGETDIR=$dirQuickTime\") -RunAs | Out-Null",
            "}"
        ]
    },
    "shortcuts": [
        [
            "iTunes.exe",
            "iTunes"
        ]
    ],
    "checkver": {
        "url": "https://en.wikipedia.org/wiki/History_of_iTunes",
        "regex": "background:#3d4;\">([d.]+)"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://www.apple.com/itunes/download/win64#/dl.7z"
            },
            "32bit": {
                "url": "https://www.apple.com/itunes/download/win32#/dl.7z"
            }
        }
    }
}
