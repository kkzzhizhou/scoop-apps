{
    "version": "24.2.6.1",
    "description": "Powerful and free office suite, a successor to OpenOffice(.org).",
    "homepage": "https://libreoffice.org/",
    "license": "MPL-2.0",
    "suggest": {
        "Visual C++ Redistributable 2015-2022": "extras/vcredist2022"
    },
    "architecture": {
        "64bit": {
            "url": "https://downloadarchive.documentfoundation.org/libreoffice/old/24.2.6.1/win/x86_64/LibreOffice_24.2.6.1_Win_x86-64.msi#/setup.msi_",
            "hash": "d31f2eaf61b7a0168a8b510bc53b27ed84e2e1710a8f559774fb372577640ecd",
            "pre_install": [
                "foreach ($z in @('soffice', 'unopkg')) {",
                "    [System.IO.File]::WriteAllLines(\"$dir\\$z.cmd\", \"@`\"%ProgramFiles%\\LibreOffice\\program\\$z.com`\"  %*\", [System.text.UTF8Encoding]($false))",
                "}"
            ]
        },
        "32bit": {
            "url": "https://downloadarchive.documentfoundation.org/libreoffice/old/24.2.6.1/win/x86/LibreOffice_24.2.6.1_Win_x86.msi#/setup.msi_",
            "hash": "62eafc38720cd0935b5dd59cba3750e5b85b000496669b44d0e8982a47ce1baf",
            "pre_install": [
                "foreach ($z in @('soffice', 'unopkg')) {",
                "    [System.IO.File]::WriteAllLines(\"$dir\\$z.cmd\", \"@`\"%ProgramFiles(x86)%\\LibreOffice\\program\\$z.com`\"  %*\", [System.text.UTF8Encoding]($false))",
                "}"
            ]
        },
        "arm64": {
            "url": "https://downloadarchive.documentfoundation.org/libreoffice/old/24.2.6.1/win/aarch64/LibreOffice_24.2.6.1_Win_aarch64.msi#/setup.msi_",
            "hash": "3aac8b89c2b8527352f4fb81c80610bfada6a8f42433f679a881654558f6af46",
            "pre_install": [
                "foreach ($z in @('soffice', 'unopkg')) {",
                "    [System.IO.File]::WriteAllLines(\"$dir\\$z.cmd\", \"@`\"%ProgramFiles%\\LibreOffice\\program\\$z.com`\"  %*\", [System.text.UTF8Encoding]($false))",
                "}"
            ]
        }
    },
    "installer": {
        "script": [
            "if (!(is_admin)) { error \"$app requires admin rights to $cmd\"; break }",
            "Start-Process 'msiexec' -Wait -Verb 'RunAs' -WindowStyle 'Hidden' -Args @('/i', \"$dir\\setup.msi_\", '/qn', '/norestart')"
        ]
    },
    "bin": [
        "soffice.cmd",
        [
            "soffice.cmd",
            "libreoffice"
        ],
        "unopkg.cmd"
    ],
    "pre_uninstall": [
        "if ($cmd -eq 'uninstall') {",
        "    if (!(is_admin)) { error \"$app requires admin rights to $cmd\"; break }",
        "    Start-Process 'msiexec' -Wait -Verb 'RunAs' -WindowStyle 'Hidden' -Args @('/x', \"$dir\\setup.msi_\", '/qn', '/norestart')",
        "}"
    ],
    "checkver": {
        "url": "https://downloadarchive.documentfoundation.org/libreoffice/old/latest/win/x86_64/",
        "regex": "LibreOffice_([\\d.]+)_Win_x86-64\\.msi"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://downloadarchive.documentfoundation.org/libreoffice/old/$version/win/x86_64/LibreOffice_$version_Win_x86-64.msi#/setup.msi_"
            },
            "32bit": {
                "url": "https://downloadarchive.documentfoundation.org/libreoffice/old/$version/win/x86/LibreOffice_$version_Win_x86.msi#/setup.msi_"
            },
            "arm64": {
                "url": "https://downloadarchive.documentfoundation.org/libreoffice/old/$version/win/aarch64/LibreOffice_$version_Win_aarch64.msi#/setup.msi_"
            }
        },
        "hash": {
            "url": "$url.sha256"
        }
    }
}
