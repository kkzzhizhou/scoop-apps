{
    "##": [
        "_edited_from:",
        "https://github.com/akirco/aki-apps/blob/master/bucket/ima-copilot.json"
    ],
    "version": "138.0.7204.3818",
    "description": "腾讯出品的一款集文档处理、知识管理和AI智能问答于一体的智能工作平台",
    "homepage": "https://ima.qq.com/",
    "license": {
        "identifier": "Proprietary",
        "url": "https://rule.tencent.com/rule/202410140002"
    },
    "url": "https://ima-app.image.myqcloud.com/win/2.2.0_3633/ima.copilot_win_x64_1018_2.2.0_3633.exe#/dl.7z",
    "hash": "d44cee22ca7605e58dca8dbea0166fc0184dd2c08ddf6edb10369c26ec388bba",
    "pre_install": [
        "Expand-7zipArchive \"$dir\\chrome.7z\" \"$dir\"",
        "Move-Item \"$dir\\Chrome-bin\\*\" \"$dir\""
    ],
    "post_install": [
        "Remove-Item \"$dir\\chrome.7z\" -Force -Recurse",
        "Remove-Item \"$dir\\Chrome-bin\" -Force -Recurse"
    ],
    "shortcuts": [
        [
            "ima.copilot.exe",
            "ima"
        ]
    ],
    "checkver": {
        "script": [
            "$prefix = 'https://github.com/SpecterShell/Dumplings/raw/refs/heads/main/Tasks/Tencent.ima-copilot'",
            "$stateYamlUrl = $prefix + '/State.yaml'",
            "$stateContent = (Invoke-WebRequest -Uri $stateYamlUrl).Content",
            "$logFileUrl = \"$prefix/$stateContent\"",
            "$logContent = Invoke-RestMethod -Uri $logFileUrl -UseBasicParsing",
            "Write-Output $logContent"
        ],
        "regex": "InstallerUrl:\\s*(?<url>.+)\\s*[\\s\\S]+?RealVersion:\\s*(?<version>[0-9.]+)"
    },
    "autoupdate": {
        "url": "$matchUrl#/dl.7z",
        "hash": {
            "url": "https://raw.githubusercontent.com/microsoft/winget-pkgs/master/manifests/t/Tencent/ima-copilot/$version/Tencent.ima-copilot.installer.yaml",
            "regex": "Architecture: x64[\\s\\S]+?InstallerSha256:\\s?(.+)"
        }
    }
}
