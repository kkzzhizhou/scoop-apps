{
    "version": "1.439.306.0",
    "description": "Microsoft Safety Scanner. A scan tool designed to find and remove malware from Windows computers.",
    "homepage": "https://learn.microsoft.com/en-us/defender-endpoint/safety-scanner-download",
    "license": "Freeware",
    "changelog": "https://www.microsoft.com/en-us/wdsi/definitions/antimalware-definition-release-notes",
    "architecture": {
        "64bit": {
            "url": "https://definitionupdates.microsoft.com/packages/content/msert.exe?packageType=Scanner&packageVersion=1.439.306.0&arch=amd64",
            "hash": "b233f411cbb1cf5438898a78ffda5e9cd6284f1c61e0b09762fb8ef5f1447188"
        },
        "32bit": {
            "url": "https://definitionupdates.microsoft.com/packages/content/msert.exe?packageType=Scanner&packageVersion=1.439.306.0&arch=x86",
            "hash": "69c1e73b002c73c2ed61f7f8813af29d304b1abdf785fe334f2de7b0c716b310"
        }
    },
    "bin": "msert.exe",
    "shortcuts": [
        [
            "msert.exe",
            "Microsoft Safety Scanner"
        ]
    ],
    "checkver": {
        "script": [
            "try { $detail = Invoke-WebRequest -Method HEAD 'https://definitionupdates.microsoft.com/packages?package=scanner&arch=x64' -MaximumRedirection 0 -ErrorAction Ignore } catch { $_.Exception.Response }",
            "if ($detail.StatusCode -eq 200) { return $detail.Headers.Location } else { return '' }"
        ],
        "regex": "packageVersion=([\\d.]+)"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://definitionupdates.microsoft.com/packages/content/msert.exe?packageType=Scanner&packageVersion=$version&arch=amd64"
            },
            "32bit": {
                "url": "https://definitionupdates.microsoft.com/packages/content/msert.exe?packageType=Scanner&packageVersion=$version&arch=x86"
            }
        }
    }
}
