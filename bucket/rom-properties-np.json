{
    "version": "2.7.1",
    "description": "This shell extension adds a few nice features to file browsers for managing video game ROM and disc images.",
    "homepage": "https://github.com/GerbilSoft/rom-properties",
    "license": {
        "identifier": "GPL-2.0-or-later",
        "url": "https://github.com/GerbilSoft/rom-properties/blob/HEAD/LICENSE"
    },
    "depends": "extras/vcredist2022",
    "url": "https://github.com/GerbilSoft/rom-properties/releases/download/v2.7.1/SetupRomProperties-2.7.1.exe",
    "hash": "17d9e19d3d9d5201c70ab0e1a6b325be7c09e7dfc31b322fc69b73695523a3cc",
    "architecture": {
        "64bit": {
            "bin": [
                "rpcli.exe",
                "amd64/rp-download.exe"
            ]
        },
        "32bit": {
            "bin": [
                "rpcli.exe",
                "i386/rp-download.exe"
            ]
        },
        "arm64": {
            "bin": [
                "rpcli.exe",
                "arm64/rp-download.exe"
            ]
        }
    },
    "pre_install": "if (-not (is_admin)) { abort \"`n[ERROR]  $app requires admin rights to $cmd.\" }",
    "installer": {
        "args": [
            "/VERYSILENT",
            "/SUPPRESSMSGBOXES",
            "/SP-",
            "/NOCANCEL",
            "/NORESTART",
            "/NOICONS",
            "/DIR=\"$dir\""
        ]
    },
    "post_install": [
        "Write-Host \"`nINFO  Restarting explorer...\" -ForegroundColor DarkGray",
        "Stop-Process -Name 'explorer' -Force -ErrorAction SilentlyContinue",
        "Start-Sleep -Milliseconds 1500"
    ],
    "shortcuts": [
        [
            "rp-config.exe",
            "ROM Properties Page Configuration"
        ]
    ],
    "pre_uninstall": "if (-not (is_admin)) { abort \"`n[ERROR]  $app requires admin rights to $cmd.\" }",
    "uninstaller": {
        "script": [
            "$args_list = @('/VERYSILENT', '/SUPPRESSMSGBOXES', '/NORESTART')",
            "Start-Process -FilePath \"$dir\\unins000.exe\" -ArgumentList $args_list -WindowStyle 'Hidden' -Wait",
            "Write-Host \"`nINFO  Restarting explorer...\" -ForegroundColor DarkGray",
            "Stop-Process -Name 'explorer' -Force -ErrorAction SilentlyContinue",
            "Start-Sleep -Milliseconds 1500"
        ]
    },
    "checkver": "github",
    "autoupdate": {
        "url": "https://github.com/GerbilSoft/rom-properties/releases/download/v$version/SetupRomProperties-$version.exe"
    }
}
