{
    "version": "4.0.1",
    "description": "A small utility that allows administration of MikroTik RouterOS using a fast and simple GUI.",
    "homepage": "https://mikrotik.com/winbox",
    "license": {
        "identifier": "Freeware",
        "url": "https://mikrotik.com/software/legal"
    },
    "notes": [
        "This manifest uses a script, which requires admin privileges, to modify Windows firewall rules for WinBox.",
        "If it failed in installation, you can manually run:",
        "gsudo \"$dir\\update-firewall-rules.ps1\""
    ],
    "depends": "main/gsudo",
    "architecture": {
        "64bit": {
            "url": "https://download.mikrotik.com/routeros/winbox/4.0.1/WinBox_Windows.zip",
            "hash": "179d58f13cf2d580097620a091414477b742d142ed1db20ea5e6129c3b2a561d",
            "bin": [
                [
                    "WinBox.exe",
                    "winbox"
                ]
            ],
            "shortcuts": [
                [
                    "WinBox.exe",
                    "WinBox"
                ]
            ]
        }
    },
    "post_install": [
        "$ScriptsDir = Find-BucketDirectory -Root -Name $bucket | Join-Path -ChildPath \"scripts\\WinBox-v4\"",
        "$BinPath = Get-ChildItem -Path \"$dir\" -Filter \"WinBox.exe\" | Select-Object -ExpandProperty Target",
        "if (Test-Path \"$ScriptsDir\\update-firewall-rules.ps1\") {",
        "    $Content = Get-Content \"$ScriptsDir\\update-firewall-rules.ps1\" -Encoding UTF8",
        "    $Content = $Content.Replace('$BinPath', \"$BinPath\")",
        "    $Content | Out-File -FilePath \"$dir\\update-firewall-rules.ps1\" -Encoding UTF8",
        "    Write-Host \"`nUpdating Windows firewall rules...\" -ForegroundColor Yellow",
        "    Write-Host \"Please approve permission request if UAC prompt pops up.\" -ForegroundColor Yellow",
        "    Start-Sleep -Seconds 1",
        "    gsudo \"$dir\\update-firewall-rules.ps1\"",
        "    if ($?) {",
        "        Write-Host \"Successfully updated Windows firewall rules!\" -ForegroundColor Green",
        "    } else {",
        "        Write-Host \"[ERROR] Failed updating Windows firewall rules!\" -ForegroundColor Red",
        "    }",
        "} else {",
        "    Write-Host \"Missing files, please re-add Scoop4kariiin bucket and re-install this app.\" -ForegroundColor Red",
        "}"
    ],
    "checkver": {
        "url": "https://mikrotik.com/download/winbox",
        "regex": ">v([\\d.]+)<"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://download.mikrotik.com/routeros/winbox/$version/WinBox_Windows.zip",
                "hash": {
                    "url": "https://download.mikrotik.com/routeros/winbox/$version/WinBox_Windows.zip.sha256"
                }
            }
        }
    }
}
